\documentclass{beamer}
\usepackage{pgfplots}
\usepgfplotslibrary{groupplots}
\usepgfplotslibrary{units}
\usepgfplotslibrary{external}
\tikzexternalize[prefix=figurecache/] 
\pgfplotsset{compat = 1.17}

\newcommand{\Oh}{\mathcal{O}}

\title{Simulating spin magnons using Runge-Kutta methods}
\author{Jonas Bueie}

\begin{document}
\frame{\titlepage}

%\maketitle
%\begin{multicols}{2}

%\section{Methods}
%We will primarily use  Heun's method for calculations.
%This is a second order Runge-Kutta method, meaning that the error is expected to fall as $\Oh(h^{-2})$ as the spacial step size $h$ is reduced.
%As a comparison, two oher methods are used: Euler's method (first order) and the "classical" Runge-Kutta method, which is of fourth order.
%
%
%\section{Results and discussion}
%In this section, the results are presented in a similar order as the tasks in \cite{tasks}.
%First, a single spin is considered, and an initial error analysis is performed.
%From there, new phenomena, including damping and more particles are gradually introduced, whilst the performance of the method is monitored and discussed.
%Finally, magnons propagation through a chain of spins is presented and discussed.

%\subsection{One spin}

%%%%%%%%%%%%%%%%%%%%%%%
%% Task 2.1: One spin %
%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}
    \vfill
    \centering
    \usebeamerfont{title}
    Part one: Single spin 
    \vfill
\end{frame}

% 1: Tilt the spin

\begin{frame}
    \frametitle{Simplest case}
\begin{figure}
    \centering
    \input{error_y.pgf}
    %\caption{Amplitude in $y$-diretion, plotted against time, of the computed and analytical solution for the simplest case of one particle in a magnetic field, with no damping and with an initial tilt. The time of the simulation and the analytical calculation are not properly aligned, because the time must be set by hand in order to achieve such an alignment.}
    %\label{error_y}
\end{figure}
\end{frame}
\begin{frame}
    \frametitle{Simplest case}
\begin{figure}
    \centering
    \input{error_z.pgf}
    %\caption{Amplitude of computed and analytical solution for the simplest case of one particle with no damping.}
    %\label{error_z}
\end{figure}
\end{frame}
\begin{frame}
    \frametitle{Phase space}
\begin{figure}
    \centering
    \input{error_x.pgf}
    %\caption{Amplitude in $x$- and $y$-direction of the computed and the analytical solution for the simplest case of one particle in a magnetic field, with no damping and an initial tilt. The figure shows that the spin is rotating in the $xy$-plane with a constant angle against the $z$-axis, as is expected for this particular case.}
    %\label{error_x}
\end{figure}
\end{frame}

% 2: Error analysis
\begin{frame}
    \frametitle{Convergence plot}
\begin{figure}[htbp]
    \centering
    \input{./convergence_all.pgf}
    %\label{fig:convergence_plot_all}
    %\caption{Convergence plots. The figures clearly show that the classical Runge-Kutta method converges significantly faster than the other two methods. Considering runtimes, using this method with a larger step length is also beneficial. Regarding the two lower-order methods, the measured runtimes may ssuggest that Euler's method is actually more efficient than Heun's method.}
\end{figure}
\end{frame}

% 3: Damping
% TODO: Analyze exponential behaviour.
\begin{frame}
    \frametitle{With damping}
    \begin{figure}
    \centering
    \input{./one_damping.pgf}
\end{figure}
\end{frame}

\begin{frame}
    \frametitle{Analyzing the damping}
\begin{figure}
    \centering
    \input{./one_damping_exp.pgf}
\end{figure}
\end{frame}

\begin{frame}
    \frametitle{Varying $\alpha$}
\begin{figure}
    \centering
    \input{./one_damping_exp_2.pgf}
\end{figure}
\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Task 2.2: Spin chain %%
%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}
    \vfill
    \centering
    \usebeamerfont{title}
    Part two: Spin chain
    \vfill
\end{frame}

% 2.2.1: Ground states. Random initial directions.

\begin{frame}
    \frametitle{Ferromagnetic coupling}
\begin{figure}
    \centering
    \input{./chain_random_ferro.pgf}
\end{figure}
\end{frame}

\begin{frame}
    \frametitle{Antiferromagnetic coupling}
\begin{figure}
    \centering
    \input{./chain_random_antiferro.pgf}
\end{figure}
\end{frame}

% 2.2.2: Magnons. 
\begin{frame}
    \vfill
    \centering
    \usebeamerfont{title}
    Magnons
    \vfill
\end{frame}

% 1: No coupling. All spins rotate independently.
\begin{frame}
    \frametitle{No coupling}
\begin{figure}
    \centering
    \input{./multiple_spins_no_correlation.pgf}
\end{figure}
\end{frame}

% 2: Ferromagnetic coupling. A magnon propagating.
\begin{frame}
    \frametitle{No damping}
\begin{figure}
    \centering
    \input{./magnon_ferro.pgf}
\end{figure}
\end{frame}
\begin{frame}
    \frametitle{For small $t$}
\begin{figure}
    \centering
    \input{./magnon_ferro_some.pgf}
\end{figure}
\end{frame}
\begin{frame}
    \frametitle{For large $t$}
\begin{figure}
    \centering
    \input{./magnon_ferro_some_later.pgf}
\end{figure}
\end{frame}

\begin{frame}
    \frametitle{Spatial movement of the spin}
\begin{figure}
    \centering
    \input{./magnon_phase_space.pgf}
\end{figure}
\end{frame}
\begin{frame}
    \frametitle{Spatial movment of the spin}
\begin{figure}
    \centering
    \input{./magnon_phase_space_2.pgf}
\end{figure}
\end{frame}

% 3: Talk a bit about magnons.

% 4: Magnons with damping.
\begin{frame}
    \frametitle{With damping}
\begin{figure}
    \centering
    \input{./magnon_ferro_damped.pgf}
\end{figure}
\end{frame}

% 5: Magnons with antiferromagnetic coupling.
\begin{frame}
    \vfill
    \centering
    \usebeamerfont{title}
    Magnons in antiferromagnetic chain
    \vfill
\end{frame}
\begin{frame}
    \frametitle{No damping}
\begin{figure}
    \centering
    \input{./magnon_antiferro.pgf}
\end{figure}
\end{frame}

\begin{frame}
    \frametitle{With damping}
\begin{figure}
    \centering
    \input{./magnon_antiferro_damped.pgf}
\end{figure}
\end{frame}

% 6: Magnetization.
\begin{frame}
    \frametitle{Magnetization}
\begin{figure}
    \centering
    \input{./magnetization_ferro.pgf}
\end{figure}
\end{frame}


%\begin{frame}
%\begin{thebibliography}{5}
%    \bibitem{tasks}
%        Tor Nordam. \textit{Exercise 2, 2021 TFY4235 Computational Physics}
%\end{thebibliography}
%\end{frame}

\end{document}

